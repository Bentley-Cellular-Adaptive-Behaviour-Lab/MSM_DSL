package SpeciesSetup.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import java.util.List;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import java.util.Objects;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import java.util.ArrayList;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;

public final class Parameter__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x2b6159d0ceecf4f1L, "SpeciesSetup.structure.Parameter");

  public static final SMethod<Void> updateUsesRelations_id6ngYmLdX6q5 = new SMethodBuilder<Void>(new SJavaCompoundTypeImpl(Void.class)).name("updateUsesRelations").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("6ngYmLdX6q5").build();
  public static final SMethod<Void> updateUsedByRelations_id6ngYmLdX8Ap = new SMethodBuilder<Void>(new SJavaCompoundTypeImpl(Void.class)).name("updateUsedByRelations").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("6ngYmLdX8Ap").build();
  public static final SMethod<Void> cleanUsesRelations_idufje78iyUN = new SMethodBuilder<Void>(new SJavaCompoundTypeImpl(Void.class)).name("cleanUsesRelations").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("ufje78iyUN").build(SMethodBuilder.createJavaParameter((Class<List<SNode>>) ((Class) Object.class), ""));
  public static final SMethod<Void> addUsesRelations_idufje78jt14 = new SMethodBuilder<Void>(new SJavaCompoundTypeImpl(Void.class)).name("addUsesRelations").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("ufje78jt14").build(SMethodBuilder.createJavaParameter((Class<List<SNode>>) ((Class) Object.class), ""));
  public static final SMethod<List<SNode>> getUsedByParameters_idufje78j_RO = new SMethodBuilder<List<SNode>>(new SJavaCompoundTypeImpl((Class<List<SNode>>) ((Class) Object.class))).name("getUsedByParameters").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("ufje78j_RO").build();
  public static final SMethod<Void> cleanUsedByRelations_idufje78jolS = new SMethodBuilder<Void>(new SJavaCompoundTypeImpl(Void.class)).name("cleanUsedByRelations").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("ufje78jolS").build(SMethodBuilder.createJavaParameter((Class<List<SNode>>) ((Class) Object.class), ""));
  public static final SMethod<Void> addUsedByRelations_idufje78k1g2 = new SMethodBuilder<Void>(new SJavaCompoundTypeImpl(Void.class)).name("addUsedByRelations").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("ufje78k1g2").build(SMethodBuilder.createJavaParameter((Class<List<SNode>>) ((Class) Object.class), ""));
  public static final SMethod<List<SNode>> getParameters_id6ngYmLdVkMJ = new SMethodBuilder<List<SNode>>(new SJavaCompoundTypeImpl((Class<List<SNode>>) ((Class) Object.class))).name("getParameters").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).id("6ngYmLdVkMJ").build(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(updateUsesRelations_id6ngYmLdX6q5, updateUsedByRelations_id6ngYmLdX8Ap, cleanUsesRelations_idufje78iyUN, addUsesRelations_idufje78jt14, getUsedByParameters_idufje78j_RO, cleanUsedByRelations_idufje78jolS, addUsedByRelations_idufje78k1g2, getParameters_id6ngYmLdVkMJ);

  private static void ___init___(@NotNull SNode __thisNode__) {
  }

  /*package*/ static void updateUsesRelations_id6ngYmLdX6q5(@NotNull SNode __thisNode__) {
    // Get the current list of parameters used in this parameter's expression.
    List<SNode> usesParameters = Parameter__BehaviorDescriptor.getParameters_id6ngYmLdVkMJ.invoke(__thisNode__, SLinkOperations.getTarget(__thisNode__, LINKS.Expression$Wv16));

    // Remove outdated references.
    Parameter__BehaviorDescriptor.cleanUsesRelations_idufje78iyUN.invoke(__thisNode__, usesParameters);

    // Add new, unique references.
    Parameter__BehaviorDescriptor.addUsesRelations_idufje78jt14.invoke(__thisNode__, usesParameters);
  }
  /*package*/ static void updateUsedByRelations_id6ngYmLdX8Ap(@NotNull SNode __thisNode__) {
    // Get the current list of parameters that use this parameter.
    List<SNode> usedByParameters = Parameter__BehaviorDescriptor.getUsedByParameters_idufje78j_RO.invoke(__thisNode__);

    // Remove outdated references.
    Parameter__BehaviorDescriptor.cleanUsedByRelations_idufje78jolS.invoke(__thisNode__, usedByParameters);

    // Add new, unique references.
    Parameter__BehaviorDescriptor.addUsedByRelations_idufje78k1g2.invoke(__thisNode__, usedByParameters);
  }
  /*package*/ static void cleanUsesRelations_idufje78iyUN(@NotNull SNode __thisNode__, List<SNode> usesParameters) {
    for (SNode ref : ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.Uses$iEoe))) {
      if (!(ListSequence.fromList(usesParameters).contains(SLinkOperations.getTarget(ref, LINKS.target$9wsE)))) {
        SNodeOperations.deleteNode(ref);
      }
    }
  }
  /*package*/ static void addUsesRelations_idufje78jt14(@NotNull SNode __thisNode__, List<SNode> usesParameters) {
    for (SNode parameter : ListSequence.fromList(usesParameters)) {
      boolean isAlreadyStored = false;
      for (SNode ref : ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.Uses$iEoe))) {
        if (Objects.equals(SLinkOperations.getTarget(ref, LINKS.target$9wsE), parameter)) {
          isAlreadyStored = true;
        }
      }
      if (!(isAlreadyStored)) {
        SNode newRef = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x65d0f96c4dec199dL, "SpeciesSetup.structure.ParameterReference"));
        SLinkOperations.setTarget(newRef, LINKS.target$9wsE, parameter);
        ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.Uses$iEoe)).addElement(newRef);
      }
    }
  }
  /*package*/ static List<SNode> getUsedByParameters_idufje78j_RO(@NotNull SNode __thisNode__) {
    // Check over all parameters in the same species container, return any that use this parameter.
    List<SNode> usedByParameters = ListSequence.fromList(new ArrayList<SNode>());
    for (SNode currentParam : ListSequence.fromList(SLinkOperations.getChildren(SNodeOperations.as(SNodeOperations.getParent(__thisNode__), CONCEPTS.SpeciesContainer$Ig), LINKS.Parameters$hoyh))) {
      // Go over the list of used parameters, these should already have been updated - so no need to call the parameter search function again.
      for (SNode ref : ListSequence.fromList(SLinkOperations.getChildren(currentParam, LINKS.Uses$iEoe))) {
        if (Objects.equals(SLinkOperations.getTarget(ref, LINKS.target$9wsE), __thisNode__)) {
          ListSequence.fromList(usedByParameters).addElement(currentParam);
        }
      }
    }
    return usedByParameters;
  }
  /*package*/ static void cleanUsedByRelations_idufje78jolS(@NotNull SNode __thisNode__, List<SNode> usedByParameters) {
    for (SNode ref : ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.UsedBy$$TT5))) {
      if (!(ListSequence.fromList(usedByParameters).contains(SLinkOperations.getTarget(ref, LINKS.target$9wsE)))) {
        SNodeOperations.deleteNode(ref);
      }
    }
  }
  /*package*/ static void addUsedByRelations_idufje78k1g2(@NotNull SNode __thisNode__, List<SNode> usedByParameters) {
    for (SNode parameter : ListSequence.fromList(usedByParameters)) {
      boolean isAlreadyStored = false;
      for (SNode ref : ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.UsedBy$$TT5))) {
        if (Objects.equals(SLinkOperations.getTarget(ref, LINKS.target$9wsE), parameter)) {
          isAlreadyStored = true;
        }
      }
      if (!(isAlreadyStored)) {
        SNode newRef = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x65d0f96c4dec199dL, "SpeciesSetup.structure.ParameterReference"));
        SLinkOperations.setTarget(newRef, LINKS.target$9wsE, parameter);
        ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.UsedBy$$TT5)).addElement(newRef);
      }
    }
  }
  /*package*/ static List<SNode> getParameters_id6ngYmLdVkMJ(@NotNull SNode __thisNode__, SNode expr) {
    // Gets a unique list of parameters from an expression.
    assert (expr != null);
    List<SNode> foundParameters = ListSequence.fromList(new ArrayList<SNode>());
    if (ListSequence.fromList(SNodeOperations.getChildren(expr)).count() > 0) {
      // Expression has children - so check over them for parameter expressions.
      for (SNode child : ListSequence.fromList(SNodeOperations.getChildren(expr))) {
        if (SNodeOperations.isInstanceOf(child, CONCEPTS.ParameterExpression$CA) && !(ListSequence.fromList(foundParameters).contains(SLinkOperations.getTarget(SNodeOperations.as(child, CONCEPTS.ParameterExpression$CA), LINKS.Parameter$bXmh)))) {
          ListSequence.fromList(foundParameters).addElement(SLinkOperations.getTarget(SNodeOperations.as(child, CONCEPTS.ParameterExpression$CA), LINKS.Parameter$bXmh));
        } else {
          ListSequence.fromList(foundParameters).addSequence(ListSequence.fromList(Parameter__BehaviorDescriptor.getParameters_id6ngYmLdVkMJ.invoke(__thisNode__, SNodeOperations.as(child, CONCEPTS.Expression$D_))));
        }
      }
    } else {
      // Expression has no children - therefore it has a size of one, so just check if it's a parameter expression.
      if (SNodeOperations.isInstanceOf(expr, CONCEPTS.ParameterExpression$CA) && !(ListSequence.fromList(foundParameters).contains(SLinkOperations.getTarget(SNodeOperations.as(expr, CONCEPTS.ParameterExpression$CA), LINKS.Parameter$bXmh)))) {
        ListSequence.fromList(foundParameters).addElement(SLinkOperations.getTarget(SNodeOperations.as(expr, CONCEPTS.ParameterExpression$CA), LINKS.Parameter$bXmh));
      }
    }
    return foundParameters;
  }

  /*package*/ Parameter__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        updateUsesRelations_id6ngYmLdX6q5(node);
        return null;
      case 1:
        updateUsedByRelations_id6ngYmLdX8Ap(node);
        return null;
      case 2:
        cleanUsesRelations_idufje78iyUN(node, (List<SNode>) parameters[0]);
        return null;
      case 3:
        addUsesRelations_idufje78jt14(node, (List<SNode>) parameters[0]);
        return null;
      case 4:
        return (T) ((List<SNode>) getUsedByParameters_idufje78j_RO(node));
      case 5:
        cleanUsedByRelations_idufje78jolS(node, (List<SNode>) parameters[0]);
        return null;
      case 6:
        addUsedByRelations_idufje78k1g2(node, (List<SNode>) parameters[0]);
        return null;
      case 7:
        return (T) ((List<SNode>) getParameters_id6ngYmLdVkMJ(node, (SNode) parameters[0]));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink Expression$Wv16 = MetaAdapterFactory.getContainmentLink(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x2b6159d0ceecf4f1L, 0x2b6159d0ceecf504L, "Expression");
    /*package*/ static final SReferenceLink target$9wsE = MetaAdapterFactory.getReferenceLink(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x65d0f96c4dec199dL, 0x65d0f96c4dec199eL, "target");
    /*package*/ static final SContainmentLink Uses$iEoe = MetaAdapterFactory.getContainmentLink(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x2b6159d0ceecf4f1L, 0x65d0f96c4decbff8L, "Uses");
    /*package*/ static final SContainmentLink Parameters$hoyh = MetaAdapterFactory.getContainmentLink(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x2b6159d0ceecf4ebL, 0x2b6159d0ceecf745L, "Parameters");
    /*package*/ static final SContainmentLink UsedBy$$TT5 = MetaAdapterFactory.getContainmentLink(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x2b6159d0ceecf4f1L, 0x65d0f96c4dec22c1L, "UsedBy");
    /*package*/ static final SReferenceLink Parameter$bXmh = MetaAdapterFactory.getReferenceLink(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x665d03af898abc61L, 0x54e0e23243e71cb1L, "Parameter");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept SpeciesContainer$Ig = MetaAdapterFactory.getConcept(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x2b6159d0ceecf4ebL, "SpeciesSetup.structure.SpeciesContainer");
    /*package*/ static final SConcept ParameterExpression$CA = MetaAdapterFactory.getConcept(0x84970ad9a9644f15L, 0xa393dc0fcd724c0fL, 0x665d03af898abc61L, "SpeciesSetup.structure.ParameterExpression");
    /*package*/ static final SConcept Expression$D_ = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a047L, "org.iets3.core.expr.base.structure.Expression");
  }
}
