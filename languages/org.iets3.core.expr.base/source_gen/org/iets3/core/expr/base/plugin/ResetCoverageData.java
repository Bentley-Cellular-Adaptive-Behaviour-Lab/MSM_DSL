package org.iets3.core.expr.base.plugin;

/*Generated by MPS */

import com.intellij.openapi.actionSystem.AnAction;
import com.intellij.openapi.actionSystem.AnActionEvent;
import org.iets3.core.expr.base.behavior.DefaultCoverageAnalyzer;
import jetbrains.mps.project.MPSProject;
import jetbrains.mps.ide.actions.MPSCommonDataKeys;
import jetbrains.mps.nodeEditor.EditorComponent;
import jetbrains.mps.ide.editor.util.EditorComponentUtil;
import com.intellij.openapi.fileEditor.FileEditorManager;

public class ResetCoverageData extends AnAction {

  public ResetCoverageData() {
    super("Reset Coverage Data");
  }

  @Override
  public void actionPerformed(AnActionEvent event) {
    DefaultCoverageAnalyzer.reset();
    final MPSProject mpsProject = event.getRequiredData(MPSCommonDataKeys.MPS_PROJECT);
    mpsProject.getRepository().getModelAccess().runReadAction(new Runnable() {
      public void run() {
        for (EditorComponent component : EditorComponentUtil.getAllEditorComponents(FileEditorManager.getInstance(mpsProject.getProject()), true)) {
          component.rebuildEditorContent();
        }
      }
    });
  }

}
